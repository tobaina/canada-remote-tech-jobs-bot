      - name: Post jobs to Slack
        env:
          SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
          SLACK_CHANNEL: ${{ secrets.SLACK_CHANNEL }}
        run: |
          echo "Posting jobs to Slack..."

          # Extract fields safely (no JSON parsing inside the loop)
          jq -r '.jobs[:5][] | [.title, .company_name, .url] | @tsv' jobs.json |
          while IFS=$'\t' read -r TITLE COMPANY URL; do

            # Skip empty lines just in case
            [ -z "$TITLE" ] && continue

            curl -s -X POST "https://slack.com/api/chat.postMessage" \
              -H "Authorization: Bearer $SLACK_BOT_TOKEN" \
              -H "Content-Type: application/json; charset=utf-8" \
              --data "$(jq -n \
                --arg channel "$SLACK_CHANNEL" \
                --arg text "üíª *$TITLE*\nüè¢ $COMPANY\nüîó $URL" \
                '{channel:$channel, text:$text}')"

            sleep 1
          done
